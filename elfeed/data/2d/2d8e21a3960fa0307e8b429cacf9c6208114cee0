<!-- SC_OFF --><div class="md"><p>I&#39;m working on a program that launches a process and automatically restarts it when that process or one of its children is killed through SIGCHLD handling. Because the process also spawns its own child process I&#39;m making sure they&#39;re all in the same process group so I can clean up nicely at the end. The command to start the process is in a shell script and I&#39;m trying to connect stdout and stdin to before running it like so:</p> <pre><code>cmd := exec.Command(&quot;./script.sh&quot;) cmd.SysProcAttr = &amp;syscall.SysProcAttr{Setpgid: true} cmd.Stdout = os.Stdout cmd.Stdin = os.Stdin cmd.Start() </code></pre> <p>The problem with this is that when I have the SysProcAttr line in there, stdin and stdout seem to disconnect from the process (I get no output to my terminal and am unable input to the process either, but they work without the line). I need that line though because otherwise I get zombie processes when one of the child processes is killed and I try to clean things up. I have been able to work around this a little bit by changing to this:</p> <pre><code>cmd := exec.Command(&quot;./script.sh&quot;) cmd.SysProcAttr = &amp;syscall.SysProcAttr{Setpgid: true} cmd.Stdout = bufio.NewWriterSize(os.Stdout, 1) cmd.Stdin = bufio.NewReaderSize(os.Stdin, 1) cmd.Start() </code></pre> <p>This gives me the behavior I expect, though I think that it&#39;s ugly and I&#39;m not sure why it would work with bufio when the previous method doesn&#39;t. Does anybody know why this happens or a better way to achieve this?</p> </div><!-- SC_ON --> &#32; submitted by &#32; <a href="https://www.reddit.com/user/reepha"> /u/reepha </a> <br/> <span><a href="https://www.reddit.com/r/golang/comments/bwswbz/issue_with_process_management_and_terminal_io/">[link]</a></span> &#32; <span><a href="https://www.reddit.com/r/golang/comments/bwswbz/issue_with_process_management_and_terminal_io/">[comments]</a></span>